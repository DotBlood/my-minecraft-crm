<template>
  <div class="min-h-screen flex items-center justify-center bg-gray-100">
    <NuxtImg
    class="size-60 absolute top-35"
    src="https://psv4.userapi.com/s/v1/d/JRIXAH1jYAEmTawlFn1Wp-MgS_gokJSWk_mMkgKFYkh6eK0ZFTgegV-qcwfI7XMAhOzY88Zl3bkHFI0vVIcw0W5JI3WuJuvKdfsIA0pcBuo1Y_sAyY950Q/drakon.png"
  />
    <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-md">
      <h2 class="text-2xl font-bold text-center mb-6">üîë –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</h2>

      <!-- –®–∞–≥ 1: –í–≤–æ–¥ email -->
      <form v-if="step === 1" @submit.prevent="sendOtp" class="space-y-4">
        <input
          v-model="email"
          type="email"
          class="input input-bordered w-full"
          placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email"
          required
        />
        <button type="submit" class="btn btn-primary w-full">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥</button>
      </form>

      <!-- –®–∞–≥ 2: –í–≤–æ–¥ OTP -->
      <form v-if="step === 2" @submit.prevent="verifyOtp" class="space-y-4">
        <input
          v-model="otpCode"
          type="text"
          class="input input-bordered w-full"
          placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∏–∑ email"
          required
        />
        <button type="submit" class="btn btn-success w-full">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
      </form>

      <!-- –®–∞–≥ 3: –ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å -->
      <form v-if="step === 3" @submit.prevent="resetPassword" class="space-y-4">
        <input
          v-model="newPassword"
          type="password"
          class="input input-bordered w-full"
          placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å"
          required
        />
        <button type="submit" class="btn btn-success w-full">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</button>
      </form>

      <p class="text-center mt-4 text-sm">
        <NuxtLink to="/auth/login" class="text-blue-500">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—Ö–æ–¥—É</NuxtLink>
      </p>
    </div>
  </div>
</template>

<script setup>
import useRecover from "../model/useRecover";

const { step, email, otpCode, newPassword, sendOtp, verifyOtp, resetPassword } = useRecover();
</script>
